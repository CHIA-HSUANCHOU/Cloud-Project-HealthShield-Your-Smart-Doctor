version: '3.8'

services:
  # å®šç¾©å¾Œç«¯æœå‹™
  backend:
    build: ./backend        # ä½¿ç”¨ backend è³‡æ–™å¤¾å…§çš„ Dockerfile
    container_name: diabetes_backend
    ports:
      - "8000:8000"         # å°‡å®¹å™¨çš„ 8000 port å°æ‡‰åˆ°é›»è…¦çš„ 8000
    # â˜…æ–°å¢ä¸‹é¢é€™å…©è¡Œ (æ›è¼‰è³‡æ–™å¤¾)
    volumes:
      - ./backend:/app
    # â˜…ä¿®æ”¹å•Ÿå‹•æŒ‡ä»¤ (åŠ å…¥ --reload è®“ FastAPI è‡ªå‹•åµæ¸¬è®Šæ›´é‡å•Ÿ)
    command: uvicorn main:app --host 0.0.0.0 --port 8000 --reload
    networks:
      - app-network

  # å®šç¾©å‰ç«¯æœå‹™
  frontend:
    build: ./frontend       # ä½¿ç”¨ frontend è³‡æ–™å¤¾å…§çš„ Dockerfile
    container_name: diabetes_frontend
    ports:
      - "8501:8501"         # Streamlit é è¨­ port
    environment:
      # ğŸ”¥ é—œéµä¿®æ­£ï¼šå‘Šè¨´å‰ç«¯ï¼Œå¾Œç«¯åœ¨ "backend" é€™å°æ©Ÿå™¨ä¸Šï¼Œè€Œä¸æ˜¯ localhost
      - BACKEND_URL=http://backend:8000
    depends_on:
      - backend             # ç¢ºä¿å¾Œç«¯å…ˆå•Ÿå‹•
    networks:
      - app-network

# å»ºç«‹å°ˆå±¬ç¶²è·¯ï¼Œè®“å‰å¾Œç«¯å¯ä»¥äº’é€£
networks:
  app-network:
    driver: bridge